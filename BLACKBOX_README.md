 ```
# Tma_Tme_Digital

This Python script uses the PySpark library to analyze a CSV file containing call center data. The script calculates the total time logged in, time spent talking, calls answered, TMA, IDLE, and the number of calls for each agent, campaign, and segment. The results are then displayed in a table.

## Prerequisites

To run this script, you will need the following:

* Python 3.6 or later
* PySpark
* A CSV file containing call center data

## Installation

To install PySpark, run the following command:

```
pip install pyspark
```

## Usage

To run the script, open a terminal window and navigate to the directory containing the script. Then, run the following command:

```
python main.py
```

The script will output a table showing the results of the analysis.

## Code Explanation

The script starts by importing the necessary libraries.

```
import pyspark
from pyspark.sql import SparkSession
```

Next, the script creates a SparkSession object.

```
spark = SparkSession.builder.master(
    "local[1]").appName('Tma_Tme_Digital').getOrCreate()
```

The SparkSession object is used to create a DataFrame from the CSV file.

```
df = spark.read.csv("01- Código.csv", header=True, inferSchema=True)
```

The DataFrame is then used to create a temporary view.

```
df.createOrReplaceTempView("View")
```

The script then uses a SQL query to analyze the data in the temporary view.

```
resultado = spark.sql("""
    SELECT
        Data,
        Campanha,
        Segmento,
        SUM(Tempo_logado) AS Tempo_logado,
        SUM(Tempo_falado) AS Tempo_falado,
        SUM(Chamadas_atendidas) AS Chamadas_atendidas,
        SUM(TMA) AS TMA,
        SUM(IDLE) AS IDLE,
        COUNT(*) AS QTD
    FROM View
    WHERE Agente != 'Homologação' AND Data BETWEEN '2023-07-01' AND DATEADD(DAY, -1, CURRENT_DATE())
    GROUP BY Data, Campanha, Segmento
    HAVING SUM(

Generated by [BlackboxAI](https://www.useblackbox.ai)